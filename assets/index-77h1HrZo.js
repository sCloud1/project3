/* empty css             */import{E as Y,a as Z}from"./form-item-klTLtea-.js";import{u as ee,g as te,c as ae,E as se,a as le,e as oe,d as de,b as ue,f as re,h as ne,i as ie}from"./countryAddress--4ckywHt.js";import{E as ce}from"./input-qP50BFt2.js";import"./popper-uEtH8QgJ.js";import"./scrollbar-WCIx2VLh.js";import"./checkbox-toyrKoaW.js";import{E as ve}from"./button-XMZ_UMB7.js";import{_ as pe,k as c,x as _e,u as me,o as p,c as m,a as e,d as l,t as u,e as o,w as d,F as w,g as U,i as fe,V as he,n as ye,l as ge,N as be,b as Ce,p as ke,f as xe}from"./index-A1qbNCIE.js";import{r as Ve}from"./order-a3CQlHqI.js";import{u as we}from"./cart-riX8gy7w.js";import{E as A}from"./user-GNF1uiWY.js";import"./index--RoxsW5K.js";import"./event-1FCdoqwy.js";import"./isEqual-HACUfoDd.js";import"./scroll-fyVAarvL.js";import"./vnode-3H_S3K6e.js";import"./index-fh7mSV5F.js";import"./isNil--q_uwI5T.js";const n=C=>(ke("data-v-31c75103"),C=C(),xe(),C),Ae={class:"xtx-pay-checkout-page"},Le={class:"container"},Ie={class:"wrapper"},De=n(()=>e("h3",{class:"box-title"},"收货地址",-1)),Ee={class:"box-body"},Se={class:"address"},Te={class:"text"},Fe={key:0,class:"none"},je={key:1},$e=n(()=>e("span",null,[l("收"),e("i"),l("货"),e("i"),l("人：")],-1)),qe=n(()=>e("span",null,"联系方式：",-1)),ze=n(()=>e("span",null,"收货地址：",-1)),Ne={class:"action"},Ue=n(()=>e("h3",{class:"box-title"},"商品信息",-1)),Pe={class:"box-body"},Re={class:"goods"},Be=n(()=>e("thead",null,[e("tr",null,[e("th",{width:"520"},"商品信息"),e("th",{width:"170"},"单价"),e("th",{width:"170"},"数量"),e("th",{width:"170"},"小计"),e("th",{width:"170"},"实付")])],-1)),Me={href:"javascript:;",class:"info"},Oe=["src"],We={class:"right"},Ge=fe('<h3 class="box-title" data-v-31c75103>配送时间</h3><div class="box-body" data-v-31c75103><a class="my-btn active" href="javascript:;" data-v-31c75103>不限送货时间：周一至周日</a><a class="my-btn" href="javascript:;" data-v-31c75103>工作日送货：周一至周五</a><a class="my-btn" href="javascript:;" data-v-31c75103>双休日、假日送货：周六至周日</a></div><h3 class="box-title" data-v-31c75103>支付方式</h3><div class="box-body" data-v-31c75103><a class="my-btn active" href="javascript:;" data-v-31c75103>在线支付</a><a class="my-btn" href="javascript:;" data-v-31c75103>货到付款</a><span style="color:#999;" data-v-31c75103>货到付款需付5元手续费</span></div><h3 class="box-title" data-v-31c75103>金额明细</h3>',5),He={class:"box-body"},Je={class:"total"},Ke=n(()=>e("dt",null,"商品件数：",-1)),Qe=n(()=>e("dt",null,"商品总价：",-1)),Xe=n(()=>e("dt",null,[l("运"),e("i"),l("费：")],-1)),Ye=n(()=>e("dt",null,"应付总额：",-1)),Ze={class:"price"},et={class:"submit"},tt={class:"addressWrapper"},at=["onClick"],st=n(()=>e("span",null,[l("收"),e("i"),l("货"),e("i"),l("人：")],-1)),lt=n(()=>e("span",null,"联系方式：",-1)),ot=n(()=>e("span",null,"收货地址：",-1)),dt={class:"footer-button"},ut={class:"dialog-footer"},rt={class:"dialog-footer"},nt={__name:"index",setup(C){const _=c({}),v=c({}),f=c([]),L=_e();(async()=>{const i=L.query.repurchaseId?await Ve(L.query.repurchaseId):await te();_.value=i.data.result,f.value=i.data.result.userAddresses,v.value=f.value.find((t,r)=>t.isDefault===0&&(y.value=r))})();const I=async()=>{const i=await ie();f.value=i.data.result,f.value.forEach((t,r)=>t.isDefault===0&&(y.value=r))},h=c(!1),y=c(),P=()=>{v.value=f.value[y.value],h.value=!1},g=c(!1),D={receiver:"",contact:"",valueList:[],address:"",isDefault:!0,labelList:[],id:""},a=c({...D}),R={receiver:[{required:!0,message:"请输入收件人",trigger:"blur"}],contact:[{required:!0,message:"请输入联系方式",trigger:"blur"}],valueList:[{required:!0,message:"请输入联系地址",trigger:"blur"}],address:[{required:!0,message:"请输入详细地址",trigger:"blur"}]},B=ee().regionInfo,E=c(null),M=()=>{a.value.labelList=E.value.getCheckedNodes()[0].pathLabels},k=c(null),x=c(""),S=(i,t)=>{g.value=!0,i==="add"?(a.value={...D},he(()=>k.value.clearValidate()),x.value="添加收货地址"):(x.value="修改收货地址",a.value.receiver=t.receiver,a.value.contact=t.contact,a.value.valueList=[t.provinceCode,t.cityCode,t.countyCode],a.value.address=t.address,a.value.id=t.id)},O=async()=>{x.value==="添加收货地址"?(await k.value.validate(),await le({receiver:a.value.receiver,contact:a.value.contact,provinceCode:a.value.valueList[0],cityCode:a.value.valueList[1],countyCode:a.value.valueList[2],address:a.value.address,postalCode:"111111",addressTags:"家",isDefault:a.value.isDefault?0:1,fullLocation:a.value.labelList.join(" ")}),A({type:"success",message:"添加成功",duration:1500})):(await k.value.validate(),await oe(a.value.id,{receiver:a.value.receiver,contact:a.value.contact,provinceCode:a.value.valueList[0],cityCode:a.value.valueList[1],countyCode:a.value.valueList[2],address:a.value.address,postalCode:"111111",addressTags:"家",isDefault:a.value.isDefault?0:1,fullLocation:a.value.labelList.join(" "),id:a.value.id}),A({type:"success",message:"编辑成功",duration:1500})),g.value=!1,I()},W=async i=>{await de(i),A({type:"success",message:"删除成功",duration:1500}),I()},G=me(),H=async()=>{const i=await ae({deliveryTimeType:1,payType:1,payChannel:1,buyerMessage:"",goods:_.value.goods.map(r=>({skuId:r.skuId,count:r.count})),addressId:v.value.id});G.replace({path:"/pay",query:{id:i.data.result.id}}),we().getCartData()};return(i,t)=>{var F,j,$,q;const r=ve,J=ue,T=se,V=ce,b=Y,K=re,Q=ne,X=Z;return p(),m(w,null,[e("div",Ae,[e("div",Le,[e("div",Ie,[De,e("div",Ee,[e("div",Se,[e("div",Te,[v.value?(p(),m("ul",je,[e("li",null,[$e,l(u(v.value.receiver),1)]),e("li",null,[qe,l(u(v.value.contact),1)]),e("li",null,[ze,l(u(v.value.fullLocation)+" "+u(v.value.address),1)])])):(p(),m("div",Fe,"您需要先添加收货地址才可提交订单。"))]),e("div",Ne,[o(r,{size:"large",onClick:t[0]||(t[0]=s=>h.value=!0)},{default:d(()=>[l("切换地址")]),_:1}),o(r,{size:"large",onClick:t[1]||(t[1]=s=>S("add"))},{default:d(()=>[l("添加地址")]),_:1})])])]),Ue,e("div",Pe,[e("table",Re,[Be,e("tbody",null,[(p(!0),m(w,null,U(_.value.goods,s=>(p(),m("tr",{key:s.id},[e("td",null,[e("a",Me,[e("img",{src:s.picture,alt:""},null,8,Oe),e("div",We,[e("p",null,u(s.name),1),e("p",null,u(s.attrsText),1)])])]),e("td",null,"¥"+u(s.price),1),e("td",null,u(s.count),1),e("td",null,"¥"+u(s.totalPrice),1),e("td",null,"¥"+u(s.totalPayPrice),1)]))),128))])])]),Ge,e("div",He,[e("div",Je,[e("dl",null,[Ke,e("dd",null,u((F=_.value.summary)==null?void 0:F.goodsCount)+"件",1)]),e("dl",null,[Qe,e("dd",null,"¥"+u((j=_.value.summary)==null?void 0:j.totalPrice.toFixed(2)),1)]),e("dl",null,[Xe,e("dd",null,"¥"+u(($=_.value.summary)==null?void 0:$.postFee.toFixed(2)),1)]),e("dl",null,[Ye,e("dd",Ze,u((q=_.value.summary)==null?void 0:q.totalPayPrice.toFixed(2)),1)])])]),e("div",et,[o(r,{type:"primary",size:"large",onClick:H},{default:d(()=>[l("提交订单")]),_:1})])])])]),o(T,{modelValue:h.value,"onUpdate:modelValue":t[3]||(t[3]=s=>h.value=s),title:"切换收货地址",width:"30%",center:""},{footer:d(()=>[e("span",ut,[o(r,{onClick:t[2]||(t[2]=s=>h.value=!1)},{default:d(()=>[l("取消")]),_:1}),o(r,{type:"primary",onClick:P},{default:d(()=>[l("确定")]),_:1})])]),default:d(()=>[e("div",tt,[(p(!0),m(w,null,U(f.value,(s,z)=>(p(),m("div",{class:ye(["text item",{active:y.value===z}]),key:s.id,onClick:N=>y.value=z},[e("ul",null,[e("li",null,[st,l(u(s.receiver),1)]),e("li",null,[lt,l(u(s.contact),1)]),e("li",null,[ot,l(u(s.fullLocation+s.address),1)]),e("div",dt,[e("div",null,[o(r,{round:"",type:"primary",size:"small",onClick:N=>S("edit",s)},{default:d(()=>[l("编辑")]),_:2},1032,["onClick"]),o(r,{round:"",type:"danger",size:"small",onClick:N=>W(s.id)},{default:d(()=>[l("删除")]),_:2},1032,["onClick"])]),e("div",null,[s.isDefault===0?(p(),ge(J,{key:0,class:"mx-1",type:"info",size:"small"},{default:d(()=>[l("默认地址")]),_:1})):be("",!0)])])])],10,at))),128))])]),_:1},8,["modelValue"]),o(T,{modelValue:g.value,"onUpdate:modelValue":t[11]||(t[11]=s=>g.value=s),title:x.value,width:"40%",center:""},{footer:d(()=>[e("span",rt,[o(r,{onClick:t[9]||(t[9]=s=>g.value=!1)},{default:d(()=>[l("取消")]),_:1}),o(r,{type:"primary",onClick:t[10]||(t[10]=s=>O())},{default:d(()=>[l("确认")]),_:1})])]),default:d(()=>[o(X,{"label-width":"150px",model:a.value,rules:R,ref_key:"formRef",ref:k},{default:d(()=>[o(b,{label:"收货人:",prop:"receiver"},{default:d(()=>[o(V,{modelValue:a.value.receiver,"onUpdate:modelValue":t[4]||(t[4]=s=>a.value.receiver=s)},null,8,["modelValue"])]),_:1}),o(b,{label:"联系方式:",prop:"contact"},{default:d(()=>[o(V,{modelValue:a.value.contact,"onUpdate:modelValue":t[5]||(t[5]=s=>a.value.contact=s)},null,8,["modelValue"])]),_:1}),o(b,{label:"收货地址:",prop:"valueList"},{default:d(()=>[o(K,{placeholder:"选择",modelValue:a.value.valueList,"onUpdate:modelValue":t[6]||(t[6]=s=>a.value.valueList=s),options:Ce(B),onChange:M,ref_key:"cascaderRef",ref:E},null,8,["modelValue","options"])]),_:1}),o(b,{label:"详细地址:",prop:"address"},{default:d(()=>[o(V,{modelValue:a.value.address,"onUpdate:modelValue":t[7]||(t[7]=s=>a.value.address=s)},null,8,["modelValue"])]),_:1}),o(b,{label:"是否设为默认地址:",prop:"isDefault"},{default:d(()=>[o(Q,{modelValue:a.value.isDefault,"onUpdate:modelValue":t[8]||(t[8]=s=>a.value.isDefault=s)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])],64)}}},St=pe(nt,[["__scopeId","data-v-31c75103"]]);export{St as default};
